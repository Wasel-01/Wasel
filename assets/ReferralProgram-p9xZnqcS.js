import{r as e,j as s}from"./ui-CdBhIjHZ.js";import{u as t,C as r,b as a,c as l,a as d,B as i}from"./index-DCGLpGXa.js";import{I as n}from"./input-CjrF92sH.js";import{B as c}from"./badge-r3WnqSNm.js";import{u as o}from"./index-BHTt414G.js";import{U as x,n as m,G as u,a3 as j}from"./icons-qmpYOd28.js";import"./supabase-BfaVHYeC.js";import"./vendor--zLKLCTa.js";import"./utils-BeLtu-UY.js";import"./utils-f_7zD0yq.js";const h=async(...e)=>null,f=async(...e)=>[],p=async(...e)=>[],N=()=>{const{user:N}=t(),{toast:g}={toast:(e,s)=>{const{type:t="info"}=s||{};switch(t){case"success":o.success(e);break;case"error":o.error(e);break;default:o(e)}}},[y,v]=e.useState(""),[w,b]=e.useState([]),[D,S]=e.useState([]),[E,R]=e.useState(!1);e.useEffect(()=>{N&&A()},[N]);const A=async()=>{if(!N)return;const[e,s,t]=await Promise.all([h(N.id),f(N.id),p(N.id)]);e&&v(e.code),b(s||[]),S(t||[])},C=D.filter(e=>"paid"===e.status).reduce((e,s)=>e+s.amount,0),T=D.filter(e=>"pending"===e.status||"approved"===e.status).reduce((e,s)=>e+s.amount,0);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[s.jsxs(r,{children:[s.jsxs(a,{className:"flex flex-row items-center justify-between pb-2",children:[s.jsx(l,{className:"text-sm font-medium",children:"Total Referrals"}),s.jsx(x,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(d,{children:[s.jsx("div",{className:"text-2xl font-bold",children:w.length}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[w.filter(e=>"completed"===e.status).length," completed"]})]})]}),s.jsxs(r,{children:[s.jsxs(a,{className:"flex flex-row items-center justify-between pb-2",children:[s.jsx(l,{className:"text-sm font-medium",children:"Total Earned"}),s.jsx(m,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(d,{children:[s.jsxs("div",{className:"text-2xl font-bold",children:[C," AED"]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[T," AED pending"]})]})]}),s.jsxs(r,{children:[s.jsxs(a,{className:"flex flex-row items-center justify-between pb-2",children:[s.jsx(l,{className:"text-sm font-medium",children:"Available Rewards"}),s.jsx(u,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(d,{children:[s.jsx("div",{className:"text-2xl font-bold",children:D.filter(e=>"approved"===e.status).length}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Ready to claim"})]})]})]}),s.jsxs(r,{children:[s.jsx(a,{children:s.jsx(l,{children:"Your Referral Code"})}),s.jsxs(d,{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(n,{value:y,readOnly:!0,className:"font-mono text-lg"}),s.jsxs(i,{onClick:async()=>{try{await navigator.clipboard.writeText(y),R(!0),g("Referral code copied!",{type:"success"}),setTimeout(()=>R(!1),2e3)}catch(e){g("Failed to copy code",{type:"error"})}},variant:"outline",children:[s.jsx(j,{className:"h-4 w-4 mr-2"}),E?"Copied!":"Copy"]})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Share your code with friends. You'll earn 50 AED when they complete their first ride, and they'll get 25 AED as a welcome bonus!"})]})]}),s.jsxs(r,{children:[s.jsx(a,{children:s.jsx(l,{children:"Your Referrals"})}),s.jsx(d,{children:0===w.length?s.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No referrals yet. Start sharing your code!"}):s.jsx("div",{className:"space-y-3",children:w.map(e=>{var t,r,a;return s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:(null==(r=null==(t=e.referred)?void 0:t.full_name)?void 0:r[0])||"?"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:(null==(a=e.referred)?void 0:a.full_name)||"User"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(e.created_at).toLocaleDateString()})]})]}),s.jsx(c,{variant:"completed"===e.status?"default":"secondary",children:e.status})]},e.id)})})})]}),s.jsxs(r,{children:[s.jsx(a,{children:s.jsx(l,{children:"Rewards History"})}),s.jsx(d,{children:0===D.length?s.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No rewards yet"}):s.jsx("div",{className:"space-y-3",children:D.map(e=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:e.description}),s.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(e.created_at).toLocaleDateString()})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-bold text-green-600",children:["+",e.amount," AED"]}),s.jsx(c,{variant:"paid"===e.status?"default":"secondary",children:e.status})]})]},e.id))})})]})]})};export{N as ReferralProgram};
