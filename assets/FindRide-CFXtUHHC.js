import{r as e,j as s}from"./ui-CdBhIjHZ.js";import{B as a,C as t,b as i,c as r,d as l,a as n}from"./index-DCGLpGXa.js";import{I as c}from"./input-CjrF92sH.js";import{L as d}from"./label-DTBIM1Y9.js";import{B as o}from"./badge-r3WnqSNm.js";import{D as m,a as x,b as h,c as p}from"./dialog-BSZWDt91.js";import{S as g}from"./separator-DtZvCbfQ.js";import{M as j}from"./MapComponent-Dl03AF91.js";import{A as u,a as f}from"./avatar-eXxJnJha.js";import{a as v,P as y,k as N,g as b,i as w,l as M,U as k,D as A,e as S,A as C}from"./icons-qmpYOd28.js";import{u as P}from"./index-BHTt414G.js";import"./supabase-BfaVHYeC.js";import"./vendor--zLKLCTa.js";import"./utils-BeLtu-UY.js";import"./utils-f_7zD0yq.js";function T({trip:t,open:i,onClose:r,onBook:l}){var n,c,d,S,C,P,T,D,R;const[I,F]=e.useState(1);if(!t)return null;const O=[{lat:(null==(c=null==(n=t.stops)?void 0:n[0])?void 0:c.lat)||25.2048,lng:(null==(S=null==(d=t.stops)?void 0:d[0])?void 0:S.lng)||55.2708,label:t.from,type:"start"},...(null==(C=t.stops)?void 0:C.slice(1,-1).map((e,s)=>({lat:e.lat,lng:e.lng,label:e.label,type:"stop"})))||[],{lat:(null==(T=null==(P=t.stops)?void 0:P[t.stops.length-1])?void 0:T.lat)||24.4539,lng:(null==(R=null==(D=t.stops)?void 0:D[t.stops.length-1])?void 0:R.lng)||54.3773,label:t.to,type:"destination"}];return s.jsx(m,{open:i,onOpenChange:r,children:s.jsxs(x,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(h,{children:s.jsx(p,{children:"Trip Details"})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx(u,{className:"w-16 h-16",children:s.jsx(f,{className:"bg-primary text-primary-foreground text-xl",children:t.driver.initials})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{children:t.driver.name}),s.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground mt-1",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(v,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),s.jsx("span",{children:t.driver.rating})]}),s.jsx("span",{children:"â€¢"}),s.jsxs("span",{children:[t.driver.trips," trips completed"]})]}),s.jsxs("div",{className:"flex gap-2 mt-3",children:[s.jsxs(a,{size:"sm",variant:"outline",className:"gap-2",children:[s.jsx(y,{className:"w-4 h-4"}),"Call"]}),s.jsxs(a,{size:"sm",variant:"outline",className:"gap-2",children:[s.jsx(N,{className:"w-4 h-4"}),"Message"]})]})]}),s.jsx(o,{variant:"wasel"===t.tripType?"default":"secondary",children:"wasel"===t.tripType?"Wasel (ÙˆØ§ØµÙ„)":"Raje3 (Ø±Ø§Ø¬Ø¹)"})]}),s.jsx(g,{}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{children:"Route & Stops"}),s.jsx(j,{locations:O,showRoute:!0,height:"350px"})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{children:"Trip Information"}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(b,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Route"}),s.jsxs("p",{children:[t.from," â†’ ",t.to]})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(w,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Date"}),s.jsx("p",{children:t.date})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(M,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Departure Time"}),s.jsx("p",{children:t.time})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{children:"Booking Details"}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(k,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Available Seats"}),s.jsxs("p",{children:[t.seats," seats left"]})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(A,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Price per Seat"}),s.jsxs("p",{className:"text-2xl text-primary",children:["$",t.price]})]})]}),t.vehicleModel&&s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-5 h-5 flex items-center justify-center mt-0.5",children:"ðŸš—"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Vehicle"}),s.jsx("p",{children:t.vehicleModel})]})]})]})]}),t.stops&&t.stops.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(g,{}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{children:"Stops Along the Way"}),s.jsx("div",{className:"space-y-2",children:t.stops.map((e,a)=>s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[s.jsx("div",{className:`\n                        w-6 h-6 rounded-full flex items-center justify-center text-xs\n                        ${0===a?"bg-primary text-primary-foreground":a===t.stops.length-1?"bg-accent text-accent-foreground":"bg-secondary text-secondary-foreground"}\n                      `,children:0===a?"A":a===t.stops.length-1?"B":a}),s.jsx("p",{children:e.label})]},a))})]})]}),t.notes&&s.jsxs(s.Fragment,{children:[s.jsx(g,{}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{children:"Additional Notes"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:t.notes})]})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/30 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Number of Seats"}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx(a,{size:"sm",variant:"outline",onClick:()=>F(Math.max(1,I-1)),disabled:I<=1,children:"-"}),s.jsx("span",{className:"w-8 text-center",children:I}),s.jsx(a,{size:"sm",variant:"outline",onClick:()=>F(Math.min(t.seats,I+1)),disabled:I>=t.seats,children:"+"})]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Price"}),s.jsxs("p",{className:"text-2xl text-primary",children:["$",t.price*I]})]})]}),s.jsxs(a,{size:"lg",className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>{l&&l(t.id),r()},children:["Book ",I," Seat",I>1?"s":""]})]})]})]})})}const D=async e=>[{id:"driver-1",name:"Ahmed K.",rating:4.9,personality:"moderate",musicPreference:"arabic",language:"ar",gender:"male",smoking:!1,pets:!0,professionalNetworking:!0,vehicleType:"sedan",co2Efficiency:.12},{id:"driver-2",name:"Sarah M.",rating:4.8,personality:"chatty",musicPreference:"western",language:"en",gender:"female",smoking:!1,pets:!1,professionalNetworking:!1,vehicleType:"suv",co2Efficiency:.15},{id:"driver-3",name:"Omar A.",rating:4.7,personality:"quiet",musicPreference:"none",language:"ar",gender:"male",smoking:!0,pets:!0,professionalNetworking:!0,vehicleType:"hatchback",co2Efficiency:.1}].map(s=>{const a=function(e,s){let a=.8;e.gender&&"any"!==e.gender&&(a+=s.gender===e.gender?.1:-.2);e.language&&(a+=s.language.includes(e.language)?.1:-.1);return Math.max(0,Math.min(1,a))}(e,s),t=function(e,s){var a;if(!e||!s)return.5;return(null==(a={quiet:{quiet:1,moderate:.7,chatty:.3},moderate:{quiet:.7,moderate:1,chatty:.7},chatty:{quiet:.3,moderate:.7,chatty:1}}[e])?void 0:a[s])||.5}(e.personality,s.personality),i=function(e,s){let a=0,t=0;e.musicPreference&&(t++,"any"!==e.musicPreference&&s.musicPreference!==e.musicPreference||(a+=1));void 0!==e.smoking&&(t++,e.smoking===s.smoking?a+=1:!e.smoking&&s.smoking&&(a-=.5));void 0!==e.pets&&(t++,e.pets===s.pets&&(a+=1));void 0!==e.professionalNetworking&&(t++,e.professionalNetworking===s.professionalNetworking&&(a+=1));return t>0?a/t:.5}(e,s),r=.4*a+.3*t+.3*i,l=R(e.origin,e.destination),n=l*s.co2Efficiency;return{tripId:`trip-${s.id}`,driverId:s.id,matchScore:r,estimatedPrice:I(l,e.seats),estimatedDuration:Math.round(l/80*60),compatibilityScore:a,personalityMatch:t,preferencesMatch:i,driverRating:s.rating,driverName:s.name,vehicleType:s.vehicleType,co2Savings:Math.round(100*n)/100}}).sort((e,s)=>s.matchScore-e.matchScore).slice(0,5);function R(e,s){const[a,t]=e,[i,r]=s,l=(i-a)*Math.PI/180,n=(r-t)*Math.PI/180,c=Math.sin(l/2)*Math.sin(l/2)+Math.cos(a*Math.PI/180)*Math.cos(i*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}function I(e,s){const a=s>1?.8:1;return Math.round(2.5*e*a)}function F(){const[m,x]=e.useState(""),[h,p]=e.useState(""),[g,j]=e.useState(""),[u,f]=e.useState("1"),[y,N]=e.useState(null),[M,A]=e.useState(!1),[R,I]=e.useState(!1),[F,q]=e.useState("match"),[B,z]=e.useState(!1),[E,$]=e.useState([]),[W,H]=e.useState({priceRange:[0,200],minRating:4,verifiedOnly:!1,instantBook:!1,personality:"moderate",musicPreference:"any",language:"en",gender:"any",smoking:!1,pets:!1,professionalNetworking:!1}),J=e=>{N(e),A(!0)};return s.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[s.jsxs(t,{children:[s.jsxs(i,{children:[s.jsx(r,{children:"Find a Ride"}),s.jsx(l,{children:"Search for available rides across the Middle East"})]}),s.jsxs(n,{children:[s.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{children:"From"}),s.jsxs("div",{className:"relative",children:[s.jsx(b,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx(c,{placeholder:"Starting location",value:m,onChange:e=>x(e.target.value),className:"pl-10"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{children:"To"}),s.jsxs("div",{className:"relative",children:[s.jsx(b,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx(c,{placeholder:"Destination",value:h,onChange:e=>p(e.target.value),className:"pl-10"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{children:"Date"}),s.jsxs("div",{className:"relative",children:[s.jsx(w,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx(c,{type:"date",value:g,onChange:e=>j(e.target.value),className:"pl-10"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{children:"Passengers"}),s.jsxs("div",{className:"relative",children:[s.jsx(k,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx(c,{type:"number",min:"1",max:"8",value:u,onChange:e=>f(e.target.value),className:"pl-10"})]})]})]}),s.jsx(a,{className:"w-full md:w-auto mt-4 bg-primary hover:bg-primary/90 text-primary-foreground",onClick:async()=>{if(m&&h&&g){z(!0);try{const e={Dubai:[25.2048,55.2708],"Abu Dhabi":[24.4539,54.3773],Riyadh:[24.7136,46.6753],Jeddah:[21.4858,39.1925],Cairo:[30.0444,31.2357],Alexandria:[31.2001,29.9187],Doha:[25.2854,51.531],"Al Khor":[25.681,51.4969]},s=e[m]||[25.2048,55.2708],a={origin:s,destination:e[h]||[24.4539,54.3773],departureTime:g+"T08:00:00",seats:parseInt(u),maxPrice:W.priceRange[1],personality:W.personality,musicPreference:W.musicPreference,language:W.language,gender:W.gender,smoking:W.smoking,pets:W.pets,professionalNetworking:W.professionalNetworking},t=await D(a);$(t),P.success(`Found ${t.length} AI-matched rides!`)}catch(e){P.error("Failed to search rides. Please try again.")}finally{z(!1)}}else P.error("Please fill in all required fields")},disabled:B,children:B?"Finding AI Matches...":"Search Rides"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"flex items-center gap-2",children:E.length>0?s.jsxs(s.Fragment,{children:[s.jsx(S,{className:"w-5 h-5 text-primary"}),"AI-Matched Rides (",E.length,")"]}):"Available Rides"}),E.length>0&&s.jsx(o,{variant:"secondary",className:"bg-primary/10 text-primary",children:"Smart Matching Active"})]}),s.jsx("div",{className:"space-y-4",children:E.length>0?E.map(e=>s.jsx(t,{className:"hover:shadow-md transition-shadow border-l-4 border-l-primary",children:s.jsx(n,{className:"p-6",children:s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center text-white font-semibold",children:e.driverName.split(" ").map(e=>e[0]).join("")}),s.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:s.jsxs("span",{className:"text-xs font-bold text-white",children:[Math.round(100*e.matchScore),"%"]})})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"font-medium",children:e.driverName}),s.jsx(o,{variant:"outline",className:"text-xs",children:"AI Match"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(v,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),s.jsx("span",{children:e.driverRating}),s.jsx("span",{children:"â€¢"}),s.jsx("span",{children:e.vehicleType}),s.jsx("span",{children:"â€¢"}),s.jsxs("span",{className:"text-green-600",children:["ðŸ’š ",e.co2Savings,"kg COâ‚‚ saved"]})]})]})]}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"font-semibold text-primary",children:[Math.round(100*e.compatibilityScore),"%"]}),s.jsx("div",{className:"text-gray-600",children:"Compatibility"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"font-semibold text-secondary",children:[Math.round(100*e.personalityMatch),"%"]}),s.jsx("div",{className:"text-gray-600",children:"Personality"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"font-semibold text-accent",children:[Math.round(100*e.preferencesMatch),"%"]}),s.jsx("div",{className:"text-gray-600",children:"Preferences"})]})]})}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-2xl text-primary font-bold",children:["$",e.estimatedPrice]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[e.estimatedDuration,"min trip"]})]}),s.jsx(a,{className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>J(O.find(s=>s.id===parseInt(e.tripId.split("-")[1]))||O[0]),children:"Book Now"})]})]})})},e.tripId)):O.map(e=>s.jsx(t,{className:"hover:shadow-md transition-shadow",children:s.jsx(n,{className:"p-6",children:s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center",children:s.jsx("span",{children:e.driver.initials})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:e.driver.name}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(v,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),s.jsx("span",{children:e.driver.rating}),s.jsx("span",{children:"â€¢"}),s.jsxs("span",{children:[e.driver.trips," trips"]})]})]})]}),s.jsx("div",{className:"flex-1 flex items-center gap-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"font-medium",children:e.from}),s.jsx(C,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:e.to})]}),s.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600",children:[s.jsx("span",{children:e.date}),s.jsx("span",{children:"â€¢"}),s.jsx("span",{children:e.time}),s.jsx("span",{children:"â€¢"}),s.jsxs("span",{children:[e.seats," seats left"]})]})]})}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-2xl text-primary",children:["$",e.price]}),s.jsx("p",{className:"text-sm text-gray-500",children:"per seat"})]}),e.tripType&&s.jsx(o,{variant:"wasel"===e.tripType?"default":"secondary",children:"wasel"===e.tripType?"Wasel (ÙˆØ§ØµÙ„)":"Raje3 (Ø±Ø§Ø¬Ø¹)"}),s.jsx(a,{className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>J(e),children:"View Details"})]})]})})},e.id))})]}),s.jsx(T,{trip:y,open:M,onClose:()=>A(!1),onBook:e=>{P.success('Trip booked successfully! Check "My Trips" for details.')}})]})}const O=[{id:1,driver:{name:"Ahmed Hassan",initials:"AH",rating:4.8,trips:127,phone:"+971 50 123 4567"},from:"Dubai",to:"Abu Dhabi",stops:[{label:"Dubai Mall",lat:25.1972,lng:55.2744},{label:"Dubai Marina",lat:25.0805,lng:55.1396},{label:"Jebel Ali",lat:24.9857,lng:55.0272},{label:"Abu Dhabi Downtown",lat:24.4539,lng:54.3773}],date:"Oct 3, 2025",time:"08:00 AM",seats:3,price:45,tripType:"wasel",vehicleModel:"Toyota Camry 2023",notes:"Air-conditioned vehicle. Please be on time."},{id:2,driver:{name:"Sarah Mohammed",initials:"SM",rating:4.9,trips:234,phone:"+966 50 987 6543"},from:"Riyadh",to:"Jeddah",stops:[{label:"Riyadh City Center",lat:24.7136,lng:46.6753},{label:"Al Qassim",lat:26.326,lng:43.975},{label:"Medina",lat:24.5247,lng:39.5692},{label:"Jeddah Corniche",lat:21.5433,lng:39.1728}],date:"Oct 5, 2025",time:"06:00 AM",seats:2,price:120,tripType:"raje3",vehicleModel:"Honda Accord 2024",notes:"Return trip on Oct 7. Family-friendly ride."},{id:3,driver:{name:"Omar Abdullah",initials:"OA",rating:4.7,trips:98,phone:"+20 10 1234 5678"},from:"Cairo",to:"Alexandria",stops:[{label:"Cairo Downtown",lat:30.0444,lng:31.2357},{label:"Giza Pyramids",lat:29.9792,lng:31.1342},{label:"Wadi El Natrun",lat:30.3833,lng:30.35},{label:"Alexandria Corniche",lat:31.2001,lng:29.9187}],date:"Oct 4, 2025",time:"10:00 AM",seats:4,price:35,tripType:"wasel",vehicleModel:"Hyundai Elantra 2023",notes:"Comfortable ride with refreshments included."},{id:4,driver:{name:"Fatima Ali",initials:"FA",rating:5,trips:156,phone:"+974 5555 1234"},from:"Doha",to:"Al Khor",stops:[{label:"Doha Souq",lat:25.2867,lng:51.531},{label:"Lusail City",lat:25.4295,lng:51.4932},{label:"Al Khor Mall",lat:25.681,lng:51.4969}],date:"Oct 3, 2025",time:"02:00 PM",seats:3,price:25,tripType:"wasel",vehicleModel:"Nissan Altima 2024",notes:"Women and families only. Quiet and safe ride."}];export{F as FindRide};
